<!DOCTYPE html>
<!-- Copyright(c) Lester J. Clark and Contributors. -->
<!-- Licensed under the MIT License.-->
<!-- LJCDataManagerCreateDataCollection.html -->
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>CreateDataCollection</title>
  <meta charset="utf-8" />
  <meta name="author" content="Lester J. Clark" />
  <meta name="keywords" content="LJCCodeDoc, CodeDoc, Function, PHP" />
  <meta name="description" content="PHP Function code documentation." />
  <meta name="viewport" content="width=device-width" , initial-scale=1 />
  <link rel='stylesheet' type='text/css' href='../../CSS/CodeDoc.css' />
</head>
<body style="background: #F0F5FF">
  <div style="margin-left: 15px; margin-right: 10px">
    <br />
    <div class="PathText">
      / <a href="../../LJCPHPCodeDoc.html#GenCodeDocLib">LJCPHPCodeDoc</a>
      / <a href="../LJCDataManagerLib.html">LJCDataManagerLib</a>
      / <a href="LJCDataManager.html">LJCDataManager</a>
      / CreateDataCollection
    </div>
    <br />
    <div id='Header'>
      <div id='Title'>Function CreateDataCollection</div>
    </div>
    <br />
    <div id='Title'>Parameters</div>
    <div class='Text'>$collection - A Collection Object to use as a template.</div>
    <div class='Text'>$dataObject - A Data Object to use as a template.</div>
    <div class='Text'>$rows - An array of data records.</div>
    <br />
    <div class='Text'>Returns</div>
    <br />
    <div class='Text'>
      An array of Data object records or null if there are no rows.
    </div>
    <br />
    <div class='Text'>Syntax</div>
    <br />
    <div class='SectionContainer'>
      <table class='CodeTable'>
        <tbody>
          <tr><th class='CodeTable'>PHP</th></tr>
          <tr class='CodeTable'>
            <td class='CodeTable'>
              public function CreateDataCollection(object $dataCollection<br />, object $dataObject, array $rows)
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <br />
    <div class='Text'>
      Creates an array of typed Data Objects from a DB rows array.
    </div>
    <br />
    <div class='Text'>Remarks</div>
    <br />
    <div class='Text'>
      This method provides Object to Relational Mapping (ORM) as it maps an
 array  of data records into a collection of strongly  typed data objects.
 It calls the CreateDataObject() method for each data record and adds the
 resulting typed object to the strongly typed collection.
 <p>
 The collection must be an object that extends (inherits from)
 LJCCollectionLib.php class LJCCollectionBase and provides an AddObject
 method with the signature  AddObject(DataObject $item, $key = null); Where
 DataObject is a strongly typed Data Object. See LJCDbAccessLib.php class
 LJCDbColumns and LJCDbColumn for examples.
 </p>
 <p>
 The AddObject() method should supply a default key value or the method can
 be changed to require the programmer to enter it by removing the "= null"
 from the method signature.
 </p>
 The DataObject must supply a Clone() method.
    </div>
    <br />
    <div class='Text'>Example</div>
    <br />
    <div class='SectionContainer'>
      <table class='CodeTable'>
        <tbody>
          <tr class='CodeTable'><th class='CodeTable'>PHP</th></tr>
          <tr class='CodeTable'>
            <td class='CodeTable'>
              <pre style='margin-left: 2px;'>
 class Item
 {
   public function __construct()
   {
     $this->ID = 0;
     $this->Name = "";
   }
 
   // Creates an object clone.
   public function Clone(): self
   {
     $retValue = new self();
 
     $retValue->ID = $this->ID;
     $retValue->Name = $this->Name;
     return $retValue;
   } // Clone()
 
   public int $ID;
   public string $PropertyName;
 }
 
 class Items extends LJCCollectionBase
 {
   // Adds an object and key value.
   public function AddObject(Item $item, $key = null): ?Item
   {
     $methodName = "AddObject()";
 
     if (null == $key)
     {
       $key = $item->Name;
     }
 
     // AddItem() is in LJCCollectionBase.
     $retItem = $this->AddItem($item, $key);
     return $retItem;
   } // AddObject()
 
   // Retrieves the item by index.
   public function RetrieveAtIndex($index)
   {
     $retItem = $this->RetrieveItemAtIndex($index);
     return $retItem;
   }
 }
 
 // Creates an array of Data Objects from a Data Result rows array.
 private static function CreateDataCollection(LJCDataManager $manager)
 {
   $methodName = "CreateDataCollection";
 
   $rows = $manager->Load();
   $row = $rows[0];
   $id = LJCDbAccess::GetValue($row, "ID");
   $name = LJCDbAccess::GetValue($row, "Name");
 
   // result:
   // $id = First row ID column value.
   // $name = First row Name column value.
 
   // See constructor for how to create $manager.
   $items = new Items();
   $item = new Item();
   $items = $manager->CreateDataCollection($items, $item, $rows);
   if (null == $items
     || 0 == count($items))
   {
     echo("\$items was not created.");
   }
   else
   {
     $item = $items->RetrieveAtIndex(0);
 
     // result:
     // $item->ID = First item ID column value.
     // $item->Name = First item Name column value.
   }
 }</pre>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <br />
    <div class="SmallText">
      Copyright &copy Lester J. Clark and Contributors.<br />
      Licensed under the MIT License.
    </div>
  </div>
</body>
</html>
